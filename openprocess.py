import ctypes

khandle = ctypes.WinDLL("Kernel32.dll") #handle to kernel32.dll to use OpenProcess(), GetLastError()

PROCESS_ALL_ACCESS = ( 0x000F0000 | 0x00100000 | 0xFFF )  #dwDesiredAccess requires process access rights. This is checked against the security descriptor for the process

dwDesiredAccess = PROCESS_ALL_ACCESS
bInheritHandle = False #bInheritHandle takes Boolean value
dwProcessId = 0x1728 #The pid of process in hex

response = khandle.OpenProcess(dwDesiredAccess, bInheritHandle, dwProcessId) #Openprocess function part of Kernel32.dll

error = khandle.GetLastError() 
if error !=0:
    print("Couldn't get a Handle!! Error Code: {0}".format(error))
    exit(1)
if error == 0:
    print("Handle created! \n")
    print("The handle is:",response)
